<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>zjuwhw's blog</title>
    <description>This is zjuwhw's personal blog. Powered by Jekyll and Host in Github.
</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Thu, 21 Sep 2017 12:20:38 +1000</pubDate>
    <lastBuildDate>Thu, 21 Sep 2017 12:20:38 +1000</lastBuildDate>
    <generator>Jekyll v3.4.3</generator>
    
      <item>
        <title>Recombination and Recombination Rate</title>
        <description>&lt;p&gt;Recently, I read the &lt;a href=&quot;http://adamauton.com/&quot;&gt;Adam Auton&lt;/a&gt;’s PhD Thesis &lt;a href=&quot;http://adamauton.com/adam_auton_thesis.pdf&quot;&gt;“The Estimation of Recombination Rates from Population Genetic Data”&lt;/a&gt;, this blog is its notes.&lt;/p&gt;

&lt;h2 id=&quot;recombination&quot;&gt;Recombination&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Genetic_recombination&quot;&gt;Homologous recombination&lt;/a&gt; is the process by which a pair of homologous DNA sequences exchange some portion of their DNA. In eukaryotes, genetic recombination during meiosis can lead to a novel set of genetic information that can be passed on from the parents to the offspring&lt;/p&gt;

&lt;p&gt;A model for the process by which recombination occurs in eukaryotes was proposed in 1964 by Robin Holliday (HOLLIDAY 1964). It shows two possible resolutions, known as Gene Conversion and Crossover.&lt;/p&gt;

&lt;p&gt;When talking about recombination, people always means crossover as it leaves a much larger singal easy to trace.&lt;/p&gt;

&lt;p&gt;The recombination was found by &lt;a href=&quot;https://en.wikipedia.org/wiki/Thomas_Hunt_Morgan&quot;&gt;Thomas Hunt Morgan&lt;/a&gt; in 1911, when studying the chromosome theory of heredity. And his student &lt;a href=&quot;https://en.wikipedia.org/wiki/Alfred_Sturtevant&quot;&gt;Sturtevant&lt;/a&gt; uses crossover data to construct the first genetic map in drosophila. Read more &lt;a href=&quot;https://www.nature.com/scitable/topicpage/thomas-hunt-morgan-genetic-recombination-and-gene-496&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;recombination-rate-centimorgan-cm&quot;&gt;Recombination Rate (centimorgan, cM)&lt;/h2&gt;

&lt;p&gt;A commonly used unit of recombination rate is the &lt;a href=&quot;https://en.wikipedia.org/wiki/Centimorgan&quot;&gt;centimorgan&lt;/a&gt;, which is defined as a 1% chance that two loci will be separated by a recombination event in one generation.&lt;/p&gt;

&lt;p&gt;In eukaryotes, there is a notable uniformity in the total recombination map length regardless of genome size (AWADALLA 2003). The average recombination rate is therefore negatively correlated with genome size.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/recombination.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;recombination-rate-estimation&quot;&gt;Recombination Rate Estimation&lt;/h2&gt;

&lt;p&gt;There are some methods to estimate the reombination rate.&lt;/p&gt;

&lt;h3 id=&quot;genotyping-a-large-number-of-individuals-in-families&quot;&gt;Genotyping a large number of individuals in families&lt;/h3&gt;

&lt;p&gt;In 2002, deCODE company (KONG et al. 2002) constructed a map from a large pedigree study of 869 individuals in 146 Icelandic families. They found&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;The shorter chromosomes tended to have higher recombination rates than the larger chromosomes&lt;/li&gt;
  &lt;li&gt;There was also a high degree of rate heterogeneity within chromosomes&lt;/li&gt;
  &lt;li&gt;an average of 1.65 times longer in females than in males&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;sperm-typing&quot;&gt;Sperm Typing&lt;/h3&gt;

&lt;p&gt;Sperm typing is to search for recombination sequences in the sperm product of male individuals.&lt;/p&gt;

&lt;h3 id=&quot;mhc-region&quot;&gt;MHC Region&lt;/h3&gt;

&lt;p&gt;A 216kb region of the major histocompatibility complex (MHC) on chromosome 6 has been extensively studied by sperm typing (JEFFREYS et al. 2001)&lt;/p&gt;

&lt;p&gt;The rate of recombination in these regions could be hundred or thousands of times that of the surrounding regions, and hence these areas were dubbed &lt;strong&gt;recombination hotspots&lt;/strong&gt;.&lt;/p&gt;

&lt;h3 id=&quot;population-data&quot;&gt;Population data&lt;/h3&gt;

&lt;p&gt;Recombination information can also be seem in the population genetic data.&lt;/p&gt;

&lt;p&gt;Recombination events break down the amout of LD between loci. However, it is unclear how such statistics can be directly related to the underlying recombination rate (DEVLIN and RISCH 1995).&lt;/p&gt;

&lt;p&gt;One early and simple method is known as &lt;strong&gt;four-gamete test&lt;/strong&gt; (WEIR 1979). But it has very low power.&lt;/p&gt;

&lt;p&gt;Nowadays, people, such as 23andme, use population data, such as HapMap to estimate the recombination rate using more complicated model and algorithms.&lt;/p&gt;

&lt;h3 id=&quot;the-genetic-map-provide-by-impute&quot;&gt;The genetic map provide by IMPUTE&lt;/h3&gt;

&lt;p&gt;The imputation software &lt;a href=&quot;https://mathgen.stats.ox.ac.uk/impute/impute_v2.html&quot;&gt;IMPUTE2&lt;/a&gt; provide the genetic map for human in its &lt;a href=&quot;https://mathgen.stats.ox.ac.uk/impute/1000GP_Phase3.html&quot;&gt;website&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;We can have use its data to a look the recombination across the human genome.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;library(data.table)
data = fread(&quot;genetic_map_chr1_combined_b37.txt&quot;)
plot(data$&quot;position&quot;,data$&quot;COMBINED_rate(cM/Mb)&quot;,type=&quot;l&quot;, xlab=&quot;chr1 (bp)&quot;, ylab=&quot;Recombination Rate(cM/Mb)&quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/recombination_chr1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
</description>
        <pubDate>Thu, 21 Sep 2017 00:00:00 +1000</pubDate>
        <link>http://localhost:4000/2017/09/21/recombination.html</link>
        <guid isPermaLink="true">http://localhost:4000/2017/09/21/recombination.html</guid>
        
        <category>bio</category>
        
        
      </item>
    
      <item>
        <title>Literature Collection in Quantitative Genetics</title>
        <description>&lt;h3 id=&quot;charles-darwin-1809-1882&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Charles_Darwin&quot;&gt;Charles Darwin&lt;/a&gt; (1809-1882)&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Darwin, C. (1861). On the origin of species. [&lt;a href=&quot;http://darwin-online.org.uk/converted/pdf/1861_OriginNY_F382.pdf&quot;&gt;pdf&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;gregor-mendel-1822-1884&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Gregor_Mendel&quot;&gt;Gregor Mendel&lt;/a&gt; (1822-1884)&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Mendel, G. (1865). Experiments in plant hybridization. [&lt;a href=&quot;http://old.esp.org/foundations/genetics/classical/gm-65-a.pdf&quot;&gt;pdf&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;francis-galton-1822-1911&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Francis_Galton&quot;&gt;Francis Galton&lt;/a&gt; (1822-1911)&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Galton, F. (1877). Typical laws of heredity. Nature. [&lt;a href=&quot;http://galton.org/essays/1870-1879/galton-1877-typical-laws-heredity.pdf&quot;&gt;pdf&lt;/a&gt;]&lt;/li&gt;
  &lt;li&gt;Galton, F. (1886). Regression towards mediocrity in hereditary stature. Journal of the Anthropological Institute. [&lt;a href=&quot;http://galton.org/essays/1880-1889/galton-1886-jaigi-regression-stature.pdf&quot;&gt;pdf&lt;/a&gt;]&lt;/li&gt;
  &lt;li&gt;Galton, F. (1889). Natural Inheritance. Macmillan, London [&lt;a href=&quot;http://galton.org/books/natural-inheritance/pdf/galton-nat-inh-1up-clean.pdf&quot;&gt;pdf&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;karl-pearson1857-1936&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Karl_Pearson&quot;&gt;Karl Pearson&lt;/a&gt;(1857-1936)&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Pearson, K. (1920). Notes on the History of Correlation. Biometrika. [&lt;a href=&quot;http://webspace.ship.edu/pgmarr/Geo441/Readings/Pearson%201920%20-%20Notes%20on%20the%20History%20of%20Correlation.pdf&quot;&gt;pdf&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ronald-fisher-1890-1962&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ronald_Fisher&quot;&gt;Ronald Fisher&lt;/a&gt; (1890-1962)&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Fisher, RA. (1918). The Correlation between Relatives on the Supposition of Mendelian Inheritance. Proc. Roy. Soc. Edinburgh. [&lt;a href=&quot;http://www.indiana.edu/~curtweb/L567/readings/Fisher1918.pdf&quot;&gt;pdf&lt;/a&gt;]&lt;/li&gt;
  &lt;li&gt;Fisher, RA. (1919). The Causes of Human Variability. Eugen Rev. [&lt;a href=&quot;https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2942138/pdf/eugenrev00354-0021.pdf&quot;&gt;pdf&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;sewall-green-wright-1889-1988&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Sewall_Wright&quot;&gt;Sewall Green Wright&lt;/a&gt; (1889-1988)&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Wright, S. (1921) Systems of Mating I. The Biometric Relations betweens Parent and Offspring. Genetics. [&lt;a href=&quot;https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1200501/pdf/111.pdf&quot;&gt;pdf&lt;/a&gt;]&lt;/li&gt;
  &lt;li&gt;Wright, S. (1921) Systems of Mating II. The Effects of Inbreeding on the Genetic Composition of a Population. Genetics. [&lt;a href=&quot;https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1200502/pdf/124.pdf&quot;&gt;pdf&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;charles-roy-henderson-1911-1989&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Charles_Roy_Henderson&quot;&gt;Charles Roy Henderson&lt;/a&gt; (1911-1989)&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Henderson CR. (1949). Estimation of changes in herd environment. J Dairy Sci. [&lt;a href=&quot;http://morotalab.org/literature/pdf/henderson1949.pdf&quot;&gt;pdf&lt;/a&gt;]&lt;/li&gt;
  &lt;li&gt;Henderson CR. (1950). Estimation of genetic parameters. Ann Math Stat. [&lt;a href=&quot;http://morotalab.org/literature/pdf/henderson1950.pdf&quot;&gt;pdf&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;jay-laurence-lush-1896-1982&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Jay_Laurence_Lush&quot;&gt;Jay Laurence Lush&lt;/a&gt; (1896-1982)&lt;/h3&gt;

&lt;h3 id=&quot;reference&quot;&gt;Reference&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;Blog: &lt;a href=&quot;http://morotalab.org/literature/2015/03/07/The-Origin-of-BLUP-and-MME/&quot;&gt;The origin of BLUP and MME&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;BioRxir paper: &lt;a href=&quot;http://www.biorxiv.org/content/biorxiv/early/2016/02/15/039768.full.pdf&quot;&gt;the infinitesimal model&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://eblogution.wordpress.com/2014/07/21/benchmark-papers-in-quantitative-genetics-the-bill-hills-list-part-i/&quot;&gt;Bill Hill’s Benchmark paper list&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
        <pubDate>Fri, 08 Sep 2017 00:00:00 +1000</pubDate>
        <link>http://localhost:4000/2017/09/08/literature.html</link>
        <guid isPermaLink="true">http://localhost:4000/2017/09/08/literature.html</guid>
        
        <category>statistics</category>
        
        
      </item>
    
      <item>
        <title>sampling distribution of correlation r</title>
        <description>&lt;h2 id=&quot;two-independent-variables&quot;&gt;two independent variables&lt;/h2&gt;

&lt;p&gt;If r is the correlation coefficient of two independent variables x1 and
x2, then r should be 0. However the sample estimation of r is not
exactly 0. There is a sampling distribution around 0.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;rep = 1000; n = 25
set.seed(1)
cors = c()
for(i in 1:rep){
  x1 = rnorm(n)
  x2 = rnorm(n)
  r = cor(x1,x2)
  cors = c(cors, r)
}
layout(matrix(1:2,1,2))
par(cex.main=0.75)
plot(x1, x2, main = paste(&quot;Scatterplot of last simulation\nn=&quot;,n,&quot;, estimated r = &quot;, round(r,4), sep=&quot;&quot;))
hist(cors, main = paste(&quot;Distribution of estimated r\nmean=&quot;,round(mean(cors),4),&quot; SD=&quot;,round(sd(cors),4),&quot;\n(&quot;,rep,&quot; simulations of sample size = &quot;,n,&quot;)&quot;, sep=&quot;&quot;), xlab=expression(hat(r)), freq=F)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/samdis_cor-chunk-1-1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;two-correlated-variables&quot;&gt;two correlated variables&lt;/h2&gt;

&lt;p&gt;However, if the population correlation is not equal to 0, the
distribution of estimated r is skewed.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;rep = 1000; n = 25
set.seed(1)
cors = c()
for(i in 1:rep){
  x1 = rnorm(n)
  x2 = rnorm(n)
  r = cor(x1,x1+2*x2)
  cors = c(cors, r)
}
layout(matrix(1:2,1,2))
par(cex.main=0.75)
plot(x1, x2, main = paste(&quot;Scatterplot of last simulation\nn=&quot;,n,&quot;, estimated r = &quot;, round(r,4), sep=&quot;&quot;))
hist(cors, main = paste(&quot;Distribution of estimated r\nmean=&quot;,round(mean(cors),4),&quot; SD=&quot;,round(sd(cors),4),&quot;\n(&quot;,rep,&quot; simulations of sample size = &quot;,n,&quot;)&quot;, sep=&quot;&quot;), xlab=expression(hat(r)), freq=F)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/samdis_cor-chunk-2-1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Note that if x1 and x2 are two independent standard normal variables,
the correlation between x1 and x1+2*x2 should be:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;cor(x_1,x_1+2x_2) = \frac{cov(x_1, x_1+2x_2)}{\sqrt{var(x_1) \times var(x_1+2x_2)}}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;= \frac{cov(x_1,x_1)+2cov(x_1,x_2)}{\sqrt{var(x1)\times (var(x_1)+4var(x_2)+2\times 2 \times cov(x_1,x_2))}}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;= \frac{1+0}{\sqrt{1 \times 5}} = 0.4472136&lt;/script&gt;

&lt;h2 id=&quot;fishers-z-transformtion&quot;&gt;Fisher’s z transformtion&lt;/h2&gt;

&lt;p&gt;Fisher developed a way to r to z’:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;z' = \frac{1}{2} \times ln\frac{1+r}{1-r} \sim N( \mu, \frac{1}{\sqrt{N-3}} )&lt;/script&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;rep = 1000; n = 25
set.seed(1)
zs = c()
for(i in 1:rep){
  x1 = rnorm(n)
  x2 = rnorm(n)
  r = cor(x1,x1+2*x2)
  z = log((1+r)/(1-r))/2
  zs = c(zs, z)
}
layout(matrix(1:2,1,2))
par(cex.main=0.75)
plot(x1, x2, main = paste(&quot;Scatterplot of last simulation\nn=&quot;,n,&quot;, estimated r = &quot;, round(r,4),&quot;, z' = &quot;, round(z,4), sep=&quot;&quot;))
hist(zs, main = paste(&quot;Distribution of z'\nmean=&quot;,round(mean(zs),4),&quot; SD=&quot;,round(sd(zs),4),&quot;\n(&quot;,rep,&quot; simulations of sample size = &quot;,n,&quot;)&quot;, sep=&quot;&quot;), xlab=&quot;z'&quot;, freq=F)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/samdis_cor-chunk-3-1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;### The mean of z'
0.5 * log((1+0.4472136)/(1-0.4472136))

## [1] 0.4812118

### The standard error of z'
1/sqrt(n-3)

## [1] 0.2132007
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;http://onlinestatbook.com/2/sampling_distributions/samp_dist_r.html&quot;&gt;Sampling Distribution of Pearson’s
r&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
        <pubDate>Thu, 31 Aug 2017 00:00:00 +1000</pubDate>
        <link>http://localhost:4000/2017/08/31/sampling_cor.html</link>
        <guid isPermaLink="true">http://localhost:4000/2017/08/31/sampling_cor.html</guid>
        
        <category>statistics</category>
        
        
      </item>
    
      <item>
        <title>mean, variance, covariance and correlation</title>
        <description>&lt;h3 id=&quot;one-variable&quot;&gt;one variable&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;statistic&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;$X$&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;$X+c$&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;$c \times X$&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;$scale(X) = \frac{X-mean(X)}{SD(X)}$&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;mean&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\frac{\sum{x_i}}{n}$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;mean(X) + c&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$c \times mean(X)$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;SS (Sum of Squares)&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\sum{(x_i - \bar{x})^2} $&lt;br /&gt; $=\sum{x_i^2} - n\bar{x}^2$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$SS_X$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$c^2 \times SS_X$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;n-1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Var (Variance)&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\frac{\sum{(x_i - \bar{x})^2}}{n-1}$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Var(X)&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$c^2 \times Var(X)$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;SD (Standard Deviation)&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\sqrt{\frac{\sum{(x_i - \bar{x})^2}}{n-1}}$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;SD(X)&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$c \times SD(X)$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;two-variables&quot;&gt;two variables&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;statistic&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;$X,Y$&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;$X+c,Y$&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;$c \times X,Y$&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;$scale(X), scale(Y)$&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;SS (Sum of Squares)&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\sum(x_i-\bar{x})(y_i-\bar{y})$&lt;br /&gt; $= \sum{x_iy_i - n\bar{x}\bar{y}}$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$SS_{XY}$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$c \times SS_{XY}$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$(n-1) \times  Cor(X,Y)$&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Cov (Covariance)&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\frac{\sum(x_i-\bar{x})(y_i-\bar{y})}{n-1}$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Cov(X,Y)&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$c \times Cov(X,Y)$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Cor(X,Y)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Cor (Correlation)&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\frac{\sum(x_i-\bar{x})(y_i-\bar{y})}{\sqrt{\sum(x_i-\bar{x})^2 \times \sum(y_i-\bar{y})^2}}$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Cor(X,Y)&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Cor(X,Y)&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Cor(X,Y)&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;slr-simple-linear-regression&quot;&gt;SLR (simple linear regression)&lt;/h3&gt;

&lt;p&gt;the normal error regression model:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;Y = \beta_0 + \beta_1X + \epsilon&lt;/script&gt;

&lt;p&gt;the estimation of regression function:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\hat{Y_i} = b_0 + b_1X_i\text{, with }b_1 = \frac{SS_{XY}}{SS_X}, b_0 = \bar{Y} - b_1\bar{X}&lt;/script&gt;

&lt;p&gt;the sampling distributon&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;b_1  \sim N(\beta_1,\sigma^2(b_1))\text{, so } \frac{b_1 - \beta_1}{\sigma(b_1)} \sim N(0,1)\text{, with }\sigma^2(b_1) = \frac{\sigma^2}{SS_X}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{b_1 - \beta_1}{s(b_1)} \sim t(n-2)\text{, with }s^2(b_1) = \frac{MSE}{SS_X}&lt;/script&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;statistic&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;$X,Y$&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;$X, scale(Y)$&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;$scale(X), Y$&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;$scale(X),scale(Y)$&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;$b_1$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\frac{\sum(x_i-\bar{x})(y_i - \bar{y})}{\sum{(x_i-\bar{x})^2}}$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\frac{b_1}{SD(Y)}$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$b_1SD(X)$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$b_1\frac{SD(X)}{SD(Y)} = Cor(X,Y)$&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;$\hat{Y_i}$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$b_0+b_1X_i = \bar{y}+\frac{\sum(x_i-\bar{x})(y_i - \bar{y})}{\sum{(x_i-\bar{x})^2}}(x_i - \bar{x})$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\frac{\hat{y_i}-\bar{y}}{SD(y)}$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\hat{Y_i}$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\frac{\hat{y_i}-\bar{y}}{SD(y)}$&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;SSTO($SS_Y$)&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\sum(Y_i - \bar{Y})^2$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\frac{SSTO}{Var(Y)}$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;SSTO&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\frac{SSTO}{Var(Y)}$&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;SSE&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\sum(Y_i - \hat{Y_{i}})^2$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\frac{SSE}{Var(Y)}$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;SSE&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\frac{SSE}{Var(Y)}$&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;MSE&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\frac{\sum(Y_i - \hat{Y_i})^2}{n-2}$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\frac{MSE}{Var(Y)}$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;MSE&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\frac{MSE}{Var(Y)}$&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;SSR&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\sum(\hat{Y_i}-\bar{Y})^2$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\frac{SSR}{Var(Y)}$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;SSR&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\frac{SSR}{Var(Y)}$&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;$R^2$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$1-\frac{SSE}{SSTO} = \frac{SSR}{SSTO} = Cor(X,Y)^2$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$R^2$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$R^2$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$R^2$&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;$s(b_1)$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\sqrt{\frac{MSE}{SS_X}}$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\frac{s(b_1)}{SD(Y)}$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$s(b_1)SD(X)$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$s(b_1)\frac{SD(X)}{SD(Y)}$&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;t&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$\frac{b_1}{s(b_1)} = \frac{SS_{XY}}{\sqrt{MSE}\sqrt{SS_X}} = \pm\sqrt{(n-2)\frac{R^2}{1-R^2}}$&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;t&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;t&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;t&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;notes&quot;&gt;Notes&lt;/h3&gt;

&lt;h4 id=&quot;t2-and-r2&quot;&gt;&lt;em&gt;t&lt;/em&gt;&lt;sup&gt;2&lt;/sup&gt; and &lt;em&gt;R&lt;/em&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/h4&gt;

&lt;p&gt;$t^2 = \frac{b_1^2}{s(b_1)^2} = \frac{\frac{SS_{XY}^2}{SS_X^2}}{\frac{MSE}{SS_X}} = \frac{SS_{XY}^2}{MSE \times SS_X} = (n-2)\frac{SS_Y}{SSE}R^2 = (n-2)\frac{R^2}{\frac{SSE}{SS_Y}} = (n-2)\frac{R^2}{1-R^2}$&lt;/p&gt;

&lt;p&gt;When n is large, t(n-1) –&amp;gt; N(0,1), so &lt;em&gt;t&lt;/em&gt;&lt;sup&gt;2&lt;/sup&gt; –&amp;gt;
&lt;em&gt;χ&lt;/em&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;sup&gt;2&lt;/sup&gt;.&lt;/p&gt;

&lt;h4 id=&quot;terminology&quot;&gt;terminology&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;SSTO: total sum of squares&lt;/li&gt;
  &lt;li&gt;SSE: error/residual sum of squares&lt;/li&gt;
  &lt;li&gt;SSR: regression sum of squares&lt;/li&gt;
  &lt;li&gt;MSE: error/residual mean squares&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;b&lt;/em&gt;&lt;sub&gt;1&lt;/sub&gt;: the point estimator of &lt;em&gt;β&lt;/em&gt;&lt;sub&gt;1&lt;/sub&gt;, effect size&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;s&lt;/em&gt;(&lt;em&gt;b&lt;/em&gt;&lt;sub&gt;1&lt;/sub&gt;): the standard error of &lt;em&gt;b&lt;/em&gt;&lt;sub&gt;1&lt;/sub&gt;, the
estimated variance of &lt;em&gt;b&lt;/em&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;r-code-example&quot;&gt;R code example&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;lm_example = function(x,y){
  xmin = min(x); xmax = max(x)
  fit_lm = lm(y~x)
  b0 = fit_lm$&quot;coefficient&quot;[1]
  b1 = fit_lm$&quot;coefficient&quot;[2]
  yhat = x*b1 + b0
  yhat1 = yhat[1]
  SSTO = sum((y - mean(y))^2)
  SSE = sum(fit_lm$residuals^2)
  MSE = SSE/(length(y)-2)
  SSR = sum((yhat - mean(y))^2)
  R = cor(x,y)
  Rsq = 1 - SSE/SSTO
  s_b1 = summary(fit_lm)$coefficients[2,2]
  t = summary(fit_lm)$coefficients[2,3]
  p = summary(fit_lm)$coefficients[2,4]
  #plot(x,y)
  #lines(c(xmin, xmax),c(b0+xmin*b1, b0+xmax*b1),col=&quot;red&quot;)
  data = data.frame(b1,yhat1,SSTO,SSE,MSE,SSR,R,Rsq,s_b1,t)
  return(data)
}
x = trees$Height
y = trees$Girth
data = cbind(t(lm_example(x,y)),t(lm_example(x,scale(y))),t(lm_example(scale(x),y)),t(lm_example(scale(x),scale(y))))
colnames = c(&quot;x_y&quot;,&quot;x_scy&quot;,&quot;scx_y&quot;,&quot;scx_scy&quot;)
data

##                 x           x           x          x
## b1      0.2557471  0.08149644   1.6295728  0.5192801
## yhat1  11.7139043 -0.48897864  11.7139043 -0.4889786
## SSTO  295.4374194 30.00000000 295.4374194 30.0000000
## SSE   215.7721895 21.91044621 215.7721895 21.9104462
## MSE     7.4404203  0.75553263   7.4404203  0.7555326
## SSR    79.6652299  8.08955379  79.6652299  8.0895538
## R       0.5192801  0.51928007   0.5192801  0.5192801
## Rsq     0.2696518  0.26965179   0.2696518  0.2696518
## s_b1    0.0781583  0.02490594   0.4980101  0.1586960
## t       3.2721686  3.27216859   3.2721686  3.2721686
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
        <pubDate>Fri, 25 Aug 2017 00:00:00 +1000</pubDate>
        <link>http://localhost:4000/2017/08/25/mean_variance.html</link>
        <guid isPermaLink="true">http://localhost:4000/2017/08/25/mean_variance.html</guid>
        
        <category>statistics</category>
        
        
      </item>
    
      <item>
        <title>Remainder and quotient</title>
        <description>&lt;h2 id=&quot;from-binary-to-decimal&quot;&gt;From binary to decimal&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;binary: “1101”&lt;/li&gt;
  &lt;li&gt;decimal: “13”&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;1 × 2&lt;sup&gt;4 − 1&lt;/sup&gt; + 1 × 2&lt;sup&gt;3 − 1&lt;/sup&gt; + 0 × 2&lt;sup&gt;2 − 1&lt;/sup&gt; + 1 × 2&lt;sup&gt;1 − 1&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;=1 × 2&lt;sup&gt;3&lt;/sup&gt; + 1 × 2&lt;sup&gt;2&lt;/sup&gt; + 1 × 2&lt;sup&gt;1&lt;/sup&gt; + 1 × 2&lt;sup&gt;0&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;=8 + 4 + 1 = 13&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;BinToDec = function(x){
  sum(2^(which(rev(unlist(strsplit(as.character(x), &quot;&quot;)) == 1))-1))
}
DecToBin = function(x){
  bin=&quot;&quot;
  while(x != 0){
    bin = paste(x%%2,bin,sep=&quot;&quot;)
    x = x %/% 2
  }
  return(bin)
}

BinToDec(&quot;1101&quot;)

## [1] 13

DecToBin(13)

## [1] &quot;1101&quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h2 id=&quot;from-n-ary-to-decimal&quot;&gt;From n-ary to decimal&lt;/h2&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;NaryToDec = function(x, n){
  sum(n^(which(rev(unlist(strsplit(as.character(x), &quot;&quot;)) == 1))-1))
}
DecToNary = function(x,n){
  bin=&quot;&quot;
  while(x != 0){
    bin = paste(x%%n,bin,sep=&quot;&quot;)
    x = x %/% n
  }
  return(bin)
}

NaryToDec(&quot;1101&quot;,2)

## [1] 13

DecToNary(13,2)

## [1] &quot;1101&quot;

DecToNary(13,3)

## [1] &quot;111&quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h2 id=&quot;multiple-loop-indexs-to-one-loop-index&quot;&gt;multiple loop indexs to one loop index&lt;/h2&gt;

&lt;p&gt;It’s common for me to run a script using multiple loops to iterate.
I usually just put one for-loop into the nest of antoher for-loop.&lt;/p&gt;

&lt;p&gt;But if I would like to parallel them using different nodes in a computing cluster and
submit a job array using one index, how to do it?&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;for(a in 1:2){
  for(b in 1:3){
    for(c in 1:4){
      print(paste(a,b,c,sep=&quot; &quot;))
    }
  }
}

## [1] &quot;1 1 1&quot;
## [1] &quot;1 1 2&quot;
## [1] &quot;1 1 3&quot;
## [1] &quot;1 1 4&quot;
## [1] &quot;1 2 1&quot;
## [1] &quot;1 2 2&quot;
## [1] &quot;1 2 3&quot;
## [1] &quot;1 2 4&quot;
## [1] &quot;1 3 1&quot;
## [1] &quot;1 3 2&quot;
## [1] &quot;1 3 3&quot;
## [1] &quot;1 3 4&quot;
## [1] &quot;2 1 1&quot;
## [1] &quot;2 1 2&quot;
## [1] &quot;2 1 3&quot;
## [1] &quot;2 1 4&quot;
## [1] &quot;2 2 1&quot;
## [1] &quot;2 2 2&quot;
## [1] &quot;2 2 3&quot;
## [1] &quot;2 2 4&quot;
## [1] &quot;2 3 1&quot;
## [1] &quot;2 3 2&quot;
## [1] &quot;2 3 3&quot;
## [1] &quot;2 3 4&quot;

for(index in 1:24){
  ar = (index-1) %% 2 + 1; aq = (index-1) %/% 2
  br = (aq - 1) %% 3 + 1; bq = (aq - 1) %/% 3
  cr = (bq - 1) %% 4 + 1
  print(paste(ar,br,cr,sep=&quot; &quot;))
}

## [1] &quot;1 3 3&quot;
## [1] &quot;2 3 3&quot;
## [1] &quot;1 1 4&quot;
## [1] &quot;2 1 4&quot;
## [1] &quot;1 2 4&quot;
## [1] &quot;2 2 4&quot;
## [1] &quot;1 3 4&quot;
## [1] &quot;2 3 4&quot;
## [1] &quot;1 1 1&quot;
## [1] &quot;2 1 1&quot;
## [1] &quot;1 2 1&quot;
## [1] &quot;2 2 1&quot;
## [1] &quot;1 3 1&quot;
## [1] &quot;2 3 1&quot;
## [1] &quot;1 1 2&quot;
## [1] &quot;2 1 2&quot;
## [1] &quot;1 2 2&quot;
## [1] &quot;2 2 2&quot;
## [1] &quot;1 3 2&quot;
## [1] &quot;2 3 2&quot;
## [1] &quot;1 1 3&quot;
## [1] &quot;2 1 3&quot;
## [1] &quot;1 2 3&quot;
## [1] &quot;2 2 3&quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
        <pubDate>Mon, 21 Aug 2017 00:00:00 +1000</pubDate>
        <link>http://localhost:4000/2017/08/21/remainder_quotient.html</link>
        <guid isPermaLink="true">http://localhost:4000/2017/08/21/remainder_quotient.html</guid>
        
        <category>cs</category>
        
        
      </item>
    
      <item>
        <title>Plink bfile manipulation</title>
        <description>&lt;p&gt;&lt;a href=&quot;https://www.cog-genomics.org/plink2&quot;&gt;Plink&lt;/a&gt; is one of the most widely used software in GWAS field and its relative file format &lt;a href=&quot;https://www.cog-genomics.org/plink/1.9/formats#bed&quot;&gt;bfile&lt;/a&gt;, a binary file used to store genotype information, may be more popular as supported by other softwares (e.g. &lt;a href=&quot;http://cnsgenomics.com/software/gcta/#Overview&quot;&gt;GCTA&lt;/a&gt;) as input files.&lt;/p&gt;

&lt;h2 id=&quot;pedmap-files&quot;&gt;“ped/map” files&lt;/h2&gt;

&lt;p&gt;In the plink file formats, &lt;code class=&quot;highlighter-rouge&quot;&gt;.ped/map&lt;/code&gt; files are text files used together to store pedigree + genotype information and variant information, respectively. For example, the below commands show the basic information of the &lt;code class=&quot;highlighter-rouge&quot;&gt;test.map&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;test.ped&lt;/code&gt;, which is converted from test.bed/bim/fam files in gcta 1.26 software package.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ head -2 test.map
1	rs4475691	0	836671
1	rs28705211	0.0151734	890368

$ wc -l test.map
    1000 test.map
    
$ head -2 test.ped |cut -f 1-8 -d &quot; &quot;
1 11 0 0 1 -9 C C
2 21 0 0 2 -9 C C

$ wc -l test.ped
    3925 test.ped
$ head -1 test.ped|awk '{print NF}'
2006
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;test.map&lt;/code&gt; has 1000 lines, which represent 1000 variants with chromosome, SNP id, position in morgans and position in BP per line.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;test.ped&lt;/code&gt; has 3925 lines, which represent 3925 individuals with pedigree information in the first 6 columns and genotype information for the other columns. As one genotype has two alleles, &lt;code class=&quot;highlighter-rouge&quot;&gt;test.ped&lt;/code&gt; has 6 + 2 * 1000 = 2006 columns.&lt;/p&gt;

&lt;h2 id=&quot;bedbimfam-files&quot;&gt;“bed/bim/fam” files&lt;/h2&gt;

&lt;p&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;.bed/bim/fam&lt;/code&gt; files are also called bfile, which is the binary file of &lt;code class=&quot;highlighter-rouge&quot;&gt;.ped/map&lt;/code&gt; files. The bed file is the test file for genotype, the bim file is for variant information (similiar with map file, added with reference and alternative allele) and the fam file is the text file for pedigree information (first 6 columns of ped file).&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ head -2 test.bim
1	rs4475691	0	836671	T	C
1	rs28705211	0.0151734	890368	C	G
$ head -2 test.fam
1 11 0 0 1 -9
2 21 0 0 2 -9
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;.bed/bim/fam&lt;/code&gt; files are easy to read/write for softwares and can reduce the storage by more than 10-fold (30840+15776286/982003+34840+76286).&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ls -l test.ped test.map
-rw-r--r--  1 huanwei.wang  Group-Yang     30840 18 Aug 13:42 test.map
-rw-r--r--  1 huanwei.wang  Group-Yang  15776286 18 Aug 13:42 test.ped
$ ls -l test.bed test.bim test.fam
-rw-r-----  1 huanwei.wang  Group-Yang  982003 18 Aug 10:44 test.bed
-rw-r-----  1 huanwei.wang  Group-Yang   34840 18 Aug 10:44 test.bim
-rw-r-----  1 huanwei.wang  Group-Yang   76286 18 Aug 10:44 test.fam
$ echo &quot;&quot;|awk '{print (30840+15776286)/(982003+34840+76286)}'
14.4604
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;.bed/bim/fam&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;.ped/map&lt;/code&gt; files can be converted to each other by plink software.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# bfile to ped/map
$ plink2 --bfile test --recode --out test

# ped/map to bfile
$ plink2 --file test --make-bed --out test
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h2 id=&quot;r-package-plink2r&quot;&gt;R package “plink2R”&lt;/h2&gt;

&lt;p&gt;Sometimes we need to use bfile to do more statsitcial analysis in R, so we need to read the bfile. One strategy is to convert it into text files &lt;code class=&quot;highlighter-rouge&quot;&gt;ped/map&lt;/code&gt;, while we can also use R package &lt;a href=&quot;https://github.com/gabraham/plink2R&quot;&gt;plink2R&lt;/a&gt; to read directly.&lt;/p&gt;

&lt;p&gt;Installation&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;devtools::install_github(&quot;gabraham/plink2R/plink2R&quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Usage&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; library(plink2R)
Loading required package: Rcpp
Loading required package: RcppEigen
Warning message:
package ‘Rcpp’ was built under R version 3.4.1
&amp;gt; dat &amp;lt;- read_plink(&quot;test&quot;)
&amp;gt; dim(dat$bed)
[1] 3925 1000
&amp;gt; dim(dat$fam)
[1] 3925    6
&amp;gt; dim(dat$bim)
[1] 1000    6
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;But the plink2R is relatively slow and takes more memory, so try to manipulate bfile using plink as much as possible.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; object.size(dat)
31908168 bytes
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h2 id=&quot;c-ad-python-library-plinkio&quot;&gt;C ad Python library “plinkio”&lt;/h2&gt;

&lt;p&gt;There is also packages for C and Python lauguage, e.g. &lt;a href=&quot;https://github.com/mfranberg/libplinkio&quot;&gt;plinkio&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;from plinkio import plinkfile

plink_file = plinkfile.open( &quot;test&quot; )
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
        <pubDate>Fri, 18 Aug 2017 00:00:00 +1000</pubDate>
        <link>http://localhost:4000/2017/08/18/plink_bfile.html</link>
        <guid isPermaLink="true">http://localhost:4000/2017/08/18/plink_bfile.html</guid>
        
        <category>genetics</category>
        
        <category>GWAS</category>
        
        <category>plink</category>
        
        
      </item>
    
      <item>
        <title>P-values under null hypothesis</title>
        <description>&lt;p&gt;P values are also random variables. The distribution of p values under
null hypothesis should be a uniform one.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;set.seed(1)
y = rnorm(50)
ps = c()
for(i in 1:2000){
  x = rnorm(50)
  p = summary(lm(y~x))$coefficients[2,4]
  ps = c(ps, p)
}
hist(ps,breaks=seq(0,1,0.05),col=c(&quot;red&quot;,rep(&quot;white&quot;,19)), main = &quot;Distribution of P values under null (2000 replications)&quot;, freq=FALSE, xlab=&quot;P&quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/pvalue-chunk-1-1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Q%E2%80%93Q_plot&quot;&gt;QQ-plot&lt;/a&gt; can show the p
values follow an uniform distribution.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;library(car)
qqPlot(ps, distribution=&quot;unif&quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/pvalue-chunk-2-1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;proof&quot;&gt;Proof&lt;/h1&gt;

&lt;p&gt;&lt;a href=&quot;http://vasishth-statistics.blogspot.com.au/2016/04/a-simple-proof-that-p-value.html&quot;&gt;http://vasishth-statistics.blogspot.com.au/2016/04/a-simple-proof-that-p-value.html&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Thu, 10 Aug 2017 00:00:00 +1000</pubDate>
        <link>http://localhost:4000/2017/08/10/pvalue_null.html</link>
        <guid isPermaLink="true">http://localhost:4000/2017/08/10/pvalue_null.html</guid>
        
        <category>statistics</category>
        
        
      </item>
    
      <item>
        <title>HWE and LD</title>
        <description>&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Hardy%E2%80%93Weinberg_principle&quot;&gt;Hardy-Weinberg equilibrium&lt;/a&gt; and &lt;a href=&quot;https://en.wikipedia.org/wiki/Linkage_disequilibrium&quot;&gt;Linkage disequilibrium&lt;/a&gt; are two basic concepts in &lt;a href=&quot;https://en.wikipedia.org/wiki/Population_genetics&quot;&gt;population genetics&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&quot;defination&quot;&gt;Defination&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Hardy-Weinberg Equilibrium (HWE): &lt;strong&gt;allele and genotype frequencies&lt;/strong&gt; in a population will remain constant &lt;strong&gt;from generation to generation&lt;/strong&gt; in the absence of other evolutionary influences.&lt;/li&gt;
  &lt;li&gt;Linkage Disequilibrium (LD): the non-random association of &lt;strong&gt;alleles at different loci&lt;/strong&gt; in a given population.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;So HWE is about the allele and genotype frequencies in one locus, but LD is about alleles at different loci.&lt;/p&gt;

&lt;h3 id=&quot;hardy-weinberg-equilibrium&quot;&gt;Hardy-Weinberg Equilibrium&lt;/h3&gt;

&lt;h4 id=&quot;from-genotype-to-allele-frequencies&quot;&gt;From Genotype to Allele frequencies&lt;/h4&gt;

&lt;p&gt;For $n_{AA}, n_{Aa}, n_{aa}$ is the count of genotype AA, Aa and aa, respectively. And $n = n_{AA} + n_{Aa} + n_{aa}$.&lt;/p&gt;

&lt;p&gt;So, the count of A and a alleles are:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;n_{A} = 2 \times n_{AA} + n_{Aa}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;n_{a} = 2 \times n_{aa} + n_{Aa}&lt;/script&gt;

&lt;p&gt;The frequencies of A and a alleles are:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;p_{A} = \frac{n_{A}}{2n} = \frac{2 \times n_{AA} + n_{Aa}}{2n} = p_{AA} + \frac{1}{2}p_{Aa}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;p_{a} = \frac{n_{a}}{2n} = \frac{2 \times n_{aa} + n_{Aa}}{2n} = p_{aa} + \frac{1}{2}p_{Aa}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;p_{A} = 1 - p_{a}&lt;/script&gt;

&lt;h4 id=&quot;from-allele-to-genotype-frequencies---hwe&quot;&gt;From Allele to Genotype frequencies - HWE&lt;/h4&gt;

&lt;p&gt;We cannot directly get genotype frequencies from allele frequencies. But under Hardy-Weiberge Equilibrium, we can do it by&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;p_{AA} = p_{A}^{2}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;p_{Aa} = 2p_{A}p_{a}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;p_{aa} = p_{a}^{2}&lt;/script&gt;

&lt;p&gt;The assumptions for HWE includes:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;random mating&lt;/li&gt;
  &lt;li&gt;infinite population size (no genetic drift)&lt;/li&gt;
  &lt;li&gt;no mutation&lt;/li&gt;
  &lt;li&gt;no selection&lt;/li&gt;
  &lt;li&gt;no migration&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;In addition, we can see genotype frequencies is a binomial distribution. If SNP genotpes are coded X = 0, 1 and 2 (alleles) and the allele frequency is p, then:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;X \sim B(2, p)\text{ with }E(X) = 2p\text{ and }Var(X)=2p(1-p)&lt;/script&gt;

&lt;p&gt;We can plot the distribution of three different genotypes. In real genetics, we usually use the minor allele, so p is less than 0.5.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-{r}&quot;&gt;p = seq(0,1,0.01)
plot(p, (1-p)^2, ylab = &quot;genotype frequency&quot;, main=&quot;Under HWE&quot;,type=&quot;l&quot;, col=&quot;blue&quot;)
lines(p, 2*p*(1-p), col=&quot;green&quot;)
lines(p, p^2, col=&quot;grey&quot;)
legend(0.5,0.95,&quot;genotype = 0&quot;,lty = 1, col =&quot;blue&quot;, bty=&quot;n&quot;)
legend(0.5,0.85,&quot;genotype = 1&quot;,lty = 1, col =&quot;green&quot;, bty = &quot;n&quot;)
legend(0.5,0.75,&quot;genotype = 2&quot;,lty = 1, col =&quot;grey&quot;, bty = &quot;n&quot;)
abline(v = 0.5, lty=2)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&quot;/images/HWE_allele_genotype.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;test-for-hwe&quot;&gt;Test for HWE&lt;/h4&gt;

&lt;p&gt;In the GWAS QC step, we usually remove SNPs with extensive deviation from HWE because this can be indicative of a genotyping or genotype-calling error.&lt;/p&gt;

&lt;p&gt;The two common ways to test HWE are Chi-square test and exact test.&lt;/p&gt;

&lt;p&gt;For Chi-square test:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\chi^{2} = \frac{(n_{AA}-e{AA})^2}{e_{AA}} + \frac{(n_{Aa}-e{Aa})^2}{e_{Aa}} + \frac{(n_{aa}-e{aa})^2}{e_{aa}}&lt;/script&gt;

&lt;p&gt;where $e_{AA} = np_{A}^2$, $e_{Aa} = 2np_{A}p_{a}$, $e_{aa} = np_{a}^2$ and df = 1 (#genotype - #allele).&lt;/p&gt;

&lt;p&gt;For exact test:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;P(N_{Aa}|N_{A}) = \frac{n_{A}!n_{a}!n!2^{n_{Aa}}}{\frac{1}{2}(n_{A}-n_{Aa})!n_{Aa}!\frac{1}{2}(n_{a}-n_{Aa})!(2n)!}&lt;/script&gt;

&lt;p&gt;For example, a sample with 2504 individuals, the observed genotypes are 2467/36/1 for AA, Aa and aa. We can do the chi-square test in R.&lt;/p&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;### Observed genotype counts
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_AA&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2467&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_Aa&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;36&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_aa&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_AA&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_Aa&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_aa&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;O_geno&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_AA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_Aa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_aa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;O_geno&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;## 2467 36 1
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;### Observed allele count and frequency
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_A&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_AA&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_Aa&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_a&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_aa&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_Aa&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p_A&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p_a&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p_A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p_a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;## 0.9924121 0.007587859
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;### Expected genotype count, under HWE
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;E_AA&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p_A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;E_Aa&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p_A&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p_a&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;E_aa&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p_a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;E_geno&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;E_AA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;E_Aa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;E_aa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;E_geno&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;## 2466.144 37.71166 0.1441693
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;### Chi-square with df=1 (#genotypes - #alleles)
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chisq&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;O_geno&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;E_geno&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;E_geno&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pvalue&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pchisq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chisq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;paste&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;chisq:&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chisq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;pvalue: &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pvalue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;## chisq: 5.15844350552391 ; pvalue:  0.02313362043297
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;We can also use the R package “HardyWeinberg” to do the chi-square test.&lt;/p&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;### We can also use the R package &quot;HardyWeinberg&quot;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HardyWeinberg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HWChisq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;O_geno&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;## Chi-square test for Hardy-Weinberg equilibrium (autosomal)
## Chi2 =  5.158444 DF =  1 p-value =  0.02313362 D =  -0.8558307 f =  0.04538812
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;It’s hard to do the exact test directly in R because of the factorial calucation. So we also use the R package “HardyWeinberg”. A more common way is to use &lt;a href=&quot;https://www.cog-genomics.org/plink/1.9/filter#hwe&quot;&gt;PLINK&lt;/a&gt; “–hwe” option.&lt;/p&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;HWExact&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;O_geno&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;## Haldane Exact test for Hardy-Weinberg equilibrium (autosomal)
## using SELOME p-value
## sample counts: n =  2467 n =  36 n =  1 
## H0: HWE (D==0), H1: D &amp;lt;&amp;gt; 0 
## D =  -0.8558307 p-value =  0.1318891
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;We can see that the p-values from chi-square and exact test are quite different. In 2005, &lt;a href=&quot;http://www.sciencedirect.com/science/article/pii/S0002929707607356&quot;&gt;Wigginton et al&lt;/a&gt; has shown that the chi-square inflated type I error rates. So exact test is a better method.&lt;/p&gt;

&lt;h3 id=&quot;linkage-disequilibrium&quot;&gt;Linkage disequilibrium&lt;/h3&gt;

&lt;h4 id=&quot;disequilibrium-coefficient-d&quot;&gt;Disequilibrium coefficient (D)&lt;/h4&gt;

&lt;p&gt;For a pair of biallelic loci, there are four &lt;a href=&quot;https://en.wikipedia.org/wiki/Haplotype&quot;&gt;haplotypes&lt;/a&gt;. If there is no association between these two SNPs (linkage equilibrium), the haplotype frequencies should be:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;$p_{AB} = p_{A} \times p_{B}$&lt;/li&gt;
  &lt;li&gt;$p_{aB} = p_{a} \times p_{B}$&lt;/li&gt;
  &lt;li&gt;$p_{Ab} = p_{A} \times p_{b}$&lt;/li&gt;
  &lt;li&gt;$p_{ab} = p_{a} \times p_{b}$&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;However, if the two SNPs have nonrandom association, the LD can be defined by disequilibrium coefficient:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;$D_{AB} = p_{AB} - p_{A} \times p_{B}$&lt;/li&gt;
  &lt;li&gt;$P_{AB} = p_{A} \times p_{B} + D_{AB}$&lt;/li&gt;
  &lt;li&gt;$p_{aB} = p_{a} \times p_{B} - D_{AB}$&lt;/li&gt;
  &lt;li&gt;$p_{Ab} = p_{A} \times p_{b} - D_{AB}$&lt;/li&gt;
  &lt;li&gt;$p_{ab} = p_{a} \times p_{b} + D_{AB}$&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;other-ld-measures&quot;&gt;Other LD measures&lt;/h4&gt;

&lt;p&gt;More wildely used measures for LD are D’ (LEWONTIN 1964) and $r^{2}$ (HILL and ROBERTSON 1968).&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;D'_{AB} = \frac{D_{AB}}{D_{min}}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
D_{min} = max(-p_{A}p_{B}, -p_{a}p_{b}), if D_{AB} &lt; 0 %]]&gt;&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;D_{min} = min(p_{A}p_{b}, p_{a}p_{B}), if D_{AB} &gt; 0&lt;/script&gt;

&lt;p&gt;D′ = 1 indicates that at least one of the four possible haplotypes is absent, regardless of the allele frequencies.&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;r^{2} = \frac{D^{2}}{p_{A}p_{a}p_{B}p_{b}}&lt;/script&gt;

&lt;p&gt;$r^{2}$ is a correlation coefficient of 1/0 (all or none) indicator variables indicating the presence of A and B.&lt;/p&gt;

&lt;h4 id=&quot;influence-factor&quot;&gt;Influence Factor&lt;/h4&gt;

&lt;p&gt;Linkage disequilibrium is influenced by many factors, including,&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;selection&lt;/li&gt;
  &lt;li&gt;the rate of recombination&lt;/li&gt;
  &lt;li&gt;the rate of mutation&lt;/li&gt;
  &lt;li&gt;genetic drift&lt;/li&gt;
  &lt;li&gt;the system of mating&lt;/li&gt;
  &lt;li&gt;population structure&lt;/li&gt;
  &lt;li&gt;genetic linkage.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;an-example-in-r&quot;&gt;An example in R&lt;/h4&gt;

&lt;p&gt;Haplotype table&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;haplotype&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;ab&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Ab&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;aB&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;AB&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;frequency&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;32/5008&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1/5008&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;4975/5008&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;2*2 allele frequency table&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;allele&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;a&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;A&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Total&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;b&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;32/5008&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;32/5008&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;B&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1/5008&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;4975/5008&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;4976/5008&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Total&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1/5008&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;5007/5008&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#haplotype frequency
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pab&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pAb&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;5008&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;paB&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;5008&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pAB&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;4975&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;5008&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pAb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;paB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pAB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;## 0 0.006389776 0.0001996805 0.9934105
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#allele frequency
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pa&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;paB&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pab&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pA&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pAB&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pAb&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pb&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pab&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pAb&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pB&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;paB&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pAB&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;## 0.0001996805 0.9998003 0.006389776 0.9936102
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#D
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;D&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pAB&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pA&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pB&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;## -1.275914e-06
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#Dmin
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dmin&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pA&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pa&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dmin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;## -1.275914e-06
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#D'
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Ddot&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;D&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dmin&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Ddot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;## 1
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#r-square
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsq&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;D&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pa&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pA&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;## 1.284376e-06
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;reference&quot;&gt;Reference&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;http://bioinformatics.org.au/ws09/presentations/Day3_PVisscher.pdf&quot;&gt;ppt from Peter Visscher&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.springer.com/cn/book/9781441973375&quot;&gt;Laird et al, The Fundamentals of Modern Statistical Genetics, 2011&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://cran.r-project.org/web/packages/HardyWeinberg/vignettes/HardyWeinberg.pdf&quot;&gt;R package HardyWeinberg&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.ncbi.nlm.nih.gov/pubmed/17248194&quot;&gt;Lewontin RC. The Interaction of Selection and Linkage. I. General Considerations; Heterotic Models. Genetics, 1964.&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://link.springer.com/article/10.1007/BF01245622&quot;&gt;Hill W.G. Linkage disequilibrium in finite populations. Theoretical and Applied Genetics, 1968.&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://csg.sph.umich.edu/abecasis/class/&quot;&gt;Gonçalo’s Lecture Notes - Models in Human Genetics&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
        <pubDate>Wed, 07 Jun 2017 00:00:00 +1000</pubDate>
        <link>http://localhost:4000/2017/06/07/HWE_LD.html</link>
        <guid isPermaLink="true">http://localhost:4000/2017/06/07/HWE_LD.html</guid>
        
        <category>genetics</category>
        
        
      </item>
    
      <item>
        <title>Simple Statistic in R</title>
        <description>&lt;p&gt;After reading all the materials of &lt;a href=&quot;http://zjuwhw.github.io/2017/05/09/Stats_MOOC.html&quot;&gt;one Statistic Mooc&lt;/a&gt;, I would like to use R to practice these statistic equations.&lt;/p&gt;

&lt;h3 id=&quot;descriptive-statistics&quot;&gt;Descriptive Statistics&lt;/h3&gt;

&lt;h4 id=&quot;sample-mean&quot;&gt;sample mean&lt;/h4&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\bar{x} = \frac{1}{n}\displaystyle\sum_{i=1}^{n}x_{i}&lt;/script&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;## [1] 5.5
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;sample-variance-standard-deviation&quot;&gt;sample variance, standard deviation&lt;/h4&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;Var(x) = \frac{1}{n-1}\displaystyle\sum_{i=1}^{n}(x_{i} - \bar{x})^{2}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;Var(x) = \frac{1}{n-1}(\displaystyle\sum_{i=1}^{n}x_{i}^{2} - n\bar{x}^2)&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;SD(x) = \sqrt{Var(x)}&lt;/script&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;## [1] 9.166667
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;sd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;## [1] 3.02765
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;standard-units&quot;&gt;standard units&lt;/h4&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;z = \frac{x - \mu}{\sigma}&lt;/script&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scale&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;##             [,1]
##  [1,] -1.4863011
##  [2,] -1.1560120
##  [3,] -0.8257228
##  [4,] -0.4954337
##  [5,] -0.1651446
##  [6,]  0.1651446
##  [7,]  0.4954337
##  [8,]  0.8257228
##  [9,]  1.1560120
## [10,]  1.4863011
## attr(,&quot;scaled:center&quot;)
## [1] 5.5
## attr(,&quot;scaled:scale&quot;)
## [1] 3.02765
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;sample-covariance&quot;&gt;sample covariance&lt;/h4&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;Cov(x,y) = \frac{1}{n-1}\displaystyle\sum_{i=1}^{n}(x_{i} - \bar{x})(y_{i}-\bar{y})&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;Cov(x,y) = \frac{1}{n-1}(\displaystyle\sum_{i=1}^{n}x_{i}y_{i}-n\bar{x}\bar{y})&lt;/script&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cov&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;## [1] 16.11111
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;sample-correlation&quot;&gt;sample correlation:&lt;/h4&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;r = \frac{Cov(x, y)}{\sqrt{Var(x)Var(y)}}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;r = \frac{Cov(x, y)}{\sqrt{SD(x)SD(y)}}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;r = \frac{1}{n-1}\displaystyle\sum z_{x}z_{y}, \text{where }z_{x} = \frac{x - \bar{x}}{SD(x)}\text{and }z_{y} = \frac{y - \bar{y}}{SD(y)}&lt;/script&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;## [1] 0.9715366
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;mean-rules&quot;&gt;mean rules&lt;/h4&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;mean(x+c) = mean(x) + c&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;meam(cx) = mean(x) \times c&lt;/script&gt;

&lt;h4 id=&quot;variance-rules&quot;&gt;variance rules&lt;/h4&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;Var(cx) = c^{2}Var(x)&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;Var(x + y) = Var(x) + Var(y) + 2Cov(x, y)&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;Var(x - y) = Var(x) + Var(y) - 2Cov(x, y)&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;Var(x + c) = Var(x)&lt;/script&gt;

&lt;h4 id=&quot;covariance-rules&quot;&gt;covariance rules&lt;/h4&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;Cov(cx, y) = cCov(x, y)&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;Cov(x, y + z) = Cov(x, y) + Cov(x, z)&lt;/script&gt;

&lt;h4 id=&quot;correlation-rules&quot;&gt;Correlation rules&lt;/h4&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;Cor(cx, y) = Cor(x, y)&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;Cor(x + c, y) = Cor(x, y)&lt;/script&gt;

&lt;h3 id=&quot;regression&quot;&gt;Regression&lt;/h3&gt;

&lt;h4 id=&quot;simple-linear-regression-model&quot;&gt;simple linear regression model&lt;/h4&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;y_{i} = \beta_{0} + \beta_{1}x_{i} + \varepsilon_{i}&lt;/script&gt;

&lt;h4 id=&quot;least-squares-estimates&quot;&gt;Least squares estimates&lt;/h4&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\hat{y_{i}} = \hat{\beta_{0}} + \hat{\beta_{1}}x_{i}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\hat{\beta_{0}} = \bar{y} - \beta_{1}\bar{x}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\hat{\beta_{1}} = \frac{\sum(x_{i}-\bar{x})(y_{i}-\bar{y})}{\sum(x_{i}-\bar{x})^2} = \frac{Cov(x,y)}{Var(x)} = r \times \frac{\sqrt{Var(y)}}{\sqrt{Var(x)}}&lt;/script&gt;

&lt;h3 id=&quot;distribution&quot;&gt;Distribution&lt;/h3&gt;

&lt;h4 id=&quot;all-distribution-in-r-stats-package&quot;&gt;all distribution in R stats package&lt;/h4&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;help&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;distribution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;normal-distribution&quot;&gt;Normal Distribution&lt;/h4&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
Normal(\mu, \sigma^{2}): \frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{1}{2}(\frac{x-\mu}{\sigma})^{2}}, -\infty&lt;x&lt;\infty %]]&gt;&lt;/script&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dnorm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;l&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/stat_files/unnamed-chunk-7-1.png&quot; alt=&quot;&quot; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;h4 id=&quot;binomial-distribution&quot;&gt;Binomial Distribution&lt;/h4&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;Binomial(n,p): \binom{n}{k}p^{k}(1-p)^{n-k}, k=1,2,...,n&lt;/script&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dbinom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;l&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;k&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylab&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;p&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/stat_files/unnamed-chunk-8-1.png&quot; alt=&quot;&quot; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;de Moivre - Laplace Theorem&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Fix any p strictly between 0 and 1. As the number of trials n increases, the probability histogram for the binomial distribution looks like the nomrla curve with mean np and SD $\sqrt{np(1-p)}$&lt;/p&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;layout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ncol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dbinom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;l&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;paste&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;n = &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;k&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylab&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;p&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lines&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dnorm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;red&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/stat_files/unnamed-chunk-9-1.png&quot; alt=&quot;&quot; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;h4 id=&quot;t-distribution&quot;&gt;t distribution&lt;/h4&gt;

&lt;p&gt;With the increase of degree of freedem, t distribution is closer to the standard normal distribution.&lt;/p&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dnorm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;l&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;red&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lines&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;green&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lines&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;blue&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lines&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;grey&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;normal&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lty&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;red&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bty&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.375&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;t, df=2&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lty&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;green&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bty&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.35&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;t, df=5&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lty&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;blue&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bty&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.325&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;t, df=10&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lty&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;grey&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bty&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/stat_files/unnamed-chunk-10-1.png&quot; alt=&quot;&quot; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;h4 id=&quot;chi-square-distribution&quot;&gt;Chi-square distribution&lt;/h4&gt;

&lt;p&gt;As the degrees of freedom increase, the chi-square curve looks more and more like a normal curve.&lt;/p&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dchisq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;l&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;red&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylab&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;dchisq(x)&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lines&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dchisq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;green&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lines&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dchisq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;blue&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lines&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dchisq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;grey&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;chi-sqaure, df=1&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lty&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;red&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bty&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.225&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;chi-sqaure, df=2&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lty&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;green&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bty&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;chi-sqaure, df=5&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lty&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;blue&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bty&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.175&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;chi-sqaure, df=10&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lty&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;grey&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bty&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/stat_files/unnamed-chunk-11-1.png&quot; alt=&quot;&quot; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;h4 id=&quot;uniform-distribution&quot;&gt;Uniform distribution&lt;/h4&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;Uniform(a,b): \frac{1}{b-a}, a \leq x \leq b&lt;/script&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dunif&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/stat_files/unnamed-chunk-12-1.png&quot; alt=&quot;&quot; /&gt;&lt;!-- --&gt;&lt;/p&gt;
</description>
        <pubDate>Mon, 05 Jun 2017 00:00:00 +1000</pubDate>
        <link>http://localhost:4000/2017/06/05/Stats_R.html</link>
        <guid isPermaLink="true">http://localhost:4000/2017/06/05/Stats_R.html</guid>
        
        <category>statistics</category>
        
        
      </item>
    
      <item>
        <title>Use MathJax to write Equations in Jekyll blogs</title>
        <description>&lt;p&gt;My PhD field involves a lot of statistic, so I usually need to write math equations both by hands and, more convenient, on the internet. This is my solution.&lt;/p&gt;

&lt;h3 id=&quot;use-mathjax-for-jekyll&quot;&gt;Use &lt;a href=&quot;https://www.mathjax.org/&quot;&gt;MathJax&lt;/a&gt; for Jekyll&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;insert the code in the &lt;code class=&quot;highlighter-rouge&quot;&gt;_layouts/default.html&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;script type=&quot;text/x-mathjax-config&quot;&amp;gt;
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
&amp;lt;/script&amp;gt;
&amp;lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML&quot; type=&quot;text/javascript&quot;&amp;gt;&amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;The first part is used to enable inline equation.&lt;/p&gt;

&lt;h3 id=&quot;use-latex-to-write-equations&quot;&gt;Use LaTex to write equations&lt;/h3&gt;

&lt;p&gt;I found &lt;a href=&quot;https://en.wikibooks.org/wiki/LaTeX/Mathematics&quot;&gt;LaTex/Mathematics&lt;/a&gt; is wildly used to write equations on the website, such as &lt;a href=&quot;http://rmarkdown.rstudio.com/authoring_basics.html&quot;&gt;rmarkdown&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;For example, use &lt;code class=&quot;highlighter-rouge&quot;&gt;$$mean = \frac{\displaystyle\sum_{i=1}^{n} x_{i}}{n}$$&lt;/code&gt; to write&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;mean = \frac{\displaystyle\sum_{i=1}^{n} x_{i}}{n}&lt;/script&gt;

&lt;p&gt;Use &lt;code class=&quot;highlighter-rouge&quot;&gt;k_{n+1} = n^2 + k_n^2 - k_{n-1}&lt;/code&gt; to write&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;k_{n+1} = n^2 + k_n^2 - k_{n-1}&lt;/script&gt;

&lt;h3 id=&quot;reference&quot;&gt;Reference&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;http://blog.lostinmyterminal.com/webpages/2015/01/09/math-support-in-jekyll.html&quot;&gt;http://blog.lostinmyterminal.com/webpages/2015/01/09/math-support-in-jekyll.html&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
        <pubDate>Sun, 04 Jun 2017 00:00:00 +1000</pubDate>
        <link>http://localhost:4000/2017/06/04/MathJax.html</link>
        <guid isPermaLink="true">http://localhost:4000/2017/06/04/MathJax.html</guid>
        
        <category>statistics</category>
        
        <category>cs</category>
        
        
      </item>
    
  </channel>
</rss>
